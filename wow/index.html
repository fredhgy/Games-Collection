<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.5">
    <title>WoW</title>
    <link rel="stylesheet" type="text/css" href="css/default.css">
    <link rel="stylesheet" href="css/style.min.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: auto;
            -moz-user-select: none;
            /*火狐*/
            -webkit-user-select: none;
            /*webkit浏览器*/
            -ms-user-select: none;
            /*IE10*/
            -khtml-user-select: none;
            /*早期浏览器*/
            user-select: none;
        }
        
        div {
            margin: 20px;
            border: 0;
            padding: 0;
            width: auto;
        }
        
        .lastResult {
            color: white;
            padding: 3px;
        }
    </style>

    <!-- Buttons 库的核心文件 -->
    <link rel="stylesheet" href="css/buttons.css">

    <!-- 当需要使用带下拉菜单的按钮时才需要加载下面的 JavaScript 文件 -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="jquery.min.js"></script>
    <script src="bootstrap.min.js"></script>

    <!-- 只有使用字体图标时才需要加载 Font-Awesome -->
    <link href="css/font-awesome.min.css" rel="stylesheet">


</head>

<body onload="onload()" class="text-align: center">


    <div id="wrapper" class="wrapper">
        <header class="header htmleaf-header">
            <h1>WoW<span>alpha:<text id="version"></text><br><a href="https://www.heguangyu.net" target="_blank">© heguangyu.net</a></span></h1>
        </header>
        <main>
            <div class="container">
                <section>

                    <div>
                        <p id="turn" class="button-border button-rounded button-primary">回合:</p>
                    </div>

                    <div>
                        <p id="news" onclick=delnews() class="button-border button-rounded button-primary" style="word-break:break-word;">消息栏: <text id="newstext"></text> </p>
                    </div>

                    <div>
                        <button id="boss_status" style="display: inline" class="button button-border button-rounded button-primary">boss血量:</button>
                        <button id="garrote_dot_display" style="display: none" class="button button-border button-rounded button-primary">锁喉 dot:</button>
                        <button id="rupture_dot_display" style="display: none" class="button  button-border button-rounded button-primary">割裂 dot:</button>
                        <button id="shiv_dot_display" style="display: none" class="button  button-border button-rounded button-primary">毒刃 dot:</button>
                        <button id="envenom_dot_display" style="display: none" class="button button-border button-rounded button-primary">毒伤 dot:</button>
                        <button id="poison_dot_display" style="display: none" class="button button-border button-rounded button-primary">毒药 dot:</button>
                    </div>

                    <div>
                        <p id="totaldamage" class="button-border button-rounded button-primary" style="word-break:break-word;">总伤害:  <text id="damagetext"></text> </p>
                    </div>

                    <div>
                        <div class="btn-group">
                            <button type="button" id="talent1" class=" button button-rounded" data-toggle="dropdown">
                                天赋1<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent1_1" href="javascript:talent1_1_func()">毒药大师</a>
                                </li>
                                <li>
                                    <a id="talent1_2" href="javascript:talent1_2_func()">深谋远虑</a>
                                </li>
                                <li>
                                    <a id="talent1_3" href="javascript:talent1_3_func()">侧袭</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="talent2" class=" button button-rounded" data-toggle="dropdown">
                                天赋2<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent2_1" href="javascript:talent2_1_func()">夜行者</a>
                                </li>
                                <li>
                                    <a id="talent2_2" href="javascript:talent2_2_func()">诡诈</a>
                                </li>
                                <li>
                                    <a id="talent2_3" href="javascript:talent2_3_func()">刺客大师</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="talent4" class=" button button-rounded" data-toggle="dropdown">
                                天赋4<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent4_1" href="javascript:talent4_1_func()">精力</a>
                                </li>
                                <li>
                                    <a id="talent4_2" href="javascript:talent4_2_func()">运筹帷幄</a>
                                </li>
                                <li>
                                    <a id="talent4_3" href="javascript:talent4_3_func()">死亡标记</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="talent3" class=" button button-rounded" data-toggle="dropdown">
                                天赋3<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent3_1" href="javascript:talent3_1_func()">毒药炸弹</a>
                                </li>
                                <li>
                                    <a id="talent3_2" href="javascript:talent3_2_func()">隐刃</a>
                                </li>
                                <li>
                                    <a id="talent3_3" href="javascript:talent3_3_func()">猩红风暴</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="legend" class=" button button-rounded" data-toggle="dropdown">
                                橙装<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="legend_1" href="javascript:legend1_func()">末日之刃</a>
                                </li>
                                <li>
                                    <a id="legend_2" href="javascript:legend2_func()">佐迪克徽章</a>
                                </li>
                                <li>
                                    <a id="legend_3" href="javascript:legend3_func()">刺客大师的决议</a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div>
                        <p id="player_status" onclick="set_stats()" class="button-border button-rounded button-primary">点击设置绿字</p>
                    </div>

                    <div>
                        <div class="button-group">
                            <button id="garrote" type="button" onclick="garrote_func()" style="display: inline" class="button button-primary">锁喉</button>
                            <button id="mutilate" type="button" onclick="mutilate_func()" style="display: inline" class="button button-primary">毁伤</button>
                            <button id="shiv" type="button" onclick="shiv_func()" style="display: inline" class="button button-primary">毒刃</button>
                            <button id="kniev" type="button" onclick="kniev_func()" style="display: inline" class="button button-primary">刀扇</button>
                            <button id="ambush" type="button" onclick="ambush_func()" style="display: inline" class="button button-primary">伏击</button>
                            <button id="disapper" type="button" onclick="disapper_func()" style="display: inline" class="button button-primary">消失</button>
                        </div>
                        <br>
                        <div class="button-group">
                            <button id="rupture" type="button" onclick="rupture_func()" style="display: inline" class="button button-pill button-warning">割裂</button>
                            <button id="envenom" type="button" onclick="envenom_func()" style="display: inline" class="button button-pill button-warning">毒伤</button>
                            <button id="crimson" type="button" onclick="crimson_func()" style="display: none" class="button button-pill button-warning">猩红风暴</button>
                            <button id="deathmark" type="button" onclick="deathmark_func()" style="display: none" class="button button-pill button-action">死亡标记</button>
                            <button id="slice" type="button" onclick="slice_func()" style="display: inline" class="button button-pill button-warning">切割</button>                        
                        </div>
                        <br>
                        <div class="button-group">
                            <button id="wait" type="button" onclick="wait()" style="display: inline" class="button button-pill button-primary">发呆</button>
                        </div>

                    </div>

                    <div>
                        <p id="energy" class="button button-border button-rounded button-primary">能量:</p>
                        <p id="combo" class="button button-border button-rounded button-primary">连击点数:</p>
                        <p id="life" class="button button-border button-rounded button-primary">生命值:</p>
                    </div>

                    <div class="btn-group">
                        <button type="button" id="settings" class=" button button-rounded" data-toggle="dropdown">
                            设置<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li>
                                <a id="settings_1" href="javascript:hintsetting()">关闭提示</a>
                            </li>
                            <li>
                                <a id="settings_2" href="javascript:reset()">重置</a>
                            </li>
                            <li>
                                <a id="settings_3" href="javascript:test()">加载测试配置</a>
                            </li>
                        </ul>
                    </div>

                </section>
            </div>
        </main>
    </div>

    <script src="js/production/materialMenu.min.js"></script>

    <script>
        var localStorage = window.localStorage;

        var wowstr;
        var wow = {
            talent1: "",
            talent2: "",
            talent3: "",
            talent4: "",
            lengend: "",
            crit: "",
            haste: "",
            mastery: "",
            vers: "",
            turn: "",
            boss_life: "",
            player_life: "",
            player_ap: ""
        };
        //energy = [max, regen, rate]
        var energy = [120, 10, 1];
        var combo = 0;
        var crit_state = 0;


        //skill = [Energy, Duration, Combo, Damage, CD]
        var Attack = []
        var Garrote = [45, 18, 1, 1.08, 0];
        var Garrote_turn = 0;
        var Garrote_dot = 0;
        var Garrote_damage = 0;
        var Garrote_damage_sum = 0;
        var Mutilate = [50, 0, 2, 0.525, 0];
        var Mutilate_damage = 0;
        var Mutilate_damage_sum = 0;
        var Ambush = [50, 0, 2, 0.955, 0];

        var Shiv = [20, 9, 1, 0.5, 0];
        var Shiv_dot = 0;
        var Shiv_damage = 0;
        var Shiv_damage_sum = 0;

        //end_skill = [Energy, Duration_max, Duration_percombo, Damage_percombo, CD]
        var Rupture = [25, 24, 4, 0.25, 0]
        var Rupture_dot = 0;
        var Rupture_damage = 0;
        var Rupture_damage_sum = 0;

        var Envenom = [35, 6, 1, 0.08, 0]
        var Envenom_dot = 0;
        var Envenom_damage = 0;
        var Envenom_damage_sum = 0;

        var Attack_damage = 0;
        var Attack_damage_sum = 0;

        var Poison = [0, 12, 0.045, 0.38, 0];
        var Poison_damage = 0;
        var Poison_dot = 0;
        var Poison_damage_sum = 0;
        var Poison_state = 0;

        var newstr;
        var news = {
            newstext: ""
        }

        var hint = 1; //用于设置是否需要提醒，默认1为打开，0为关闭
        function hintsetting() {
            if (hint == 1) {
                hint = 0;
                newstext("游戏提示已关闭")
                document.getElementById("hintset").innerHTML = "打开提示";
            } else {
                hint = 1;
                newstext("游戏提示已打开")
                document.getElementById("hintset").innerHTML = "关闭提示";
            }
        }

        function restart() {
            var sure;
            sure = confirm("确认删除存档吗！?")
            if (sure == true) {
                localStorage.clear();
                location.reload();
            } else {}
        }

        function test() {
            //测试用

            wow.crit = 0.3;
            wow.haste = 0.3;
            wow.mastery = 0.3;
            wow.vers = 0.1;

            wow.player_ap = 1500;

            wow.boss_life = 1000000;

            news.newstext = "";
            newstext("已加载测试数据");
            savenews();
            save();
            onload();
            location.reload();
        }

        function onload() {

            document.getElementsByTagName('body')[0].style.zoom = 0.8

            var myDate = new Date();
            var version = myDate.toLocaleString();

            document.getElementById("version").innerHTML = "210413 - 1100";

            load();

            if (news.newstext == null) {
                news.newstext = "";
            }
            document.getElementById("newstext").innerHTML = news.newstext;

            if (wow.turn == null || wow.turn == "") {
                wow.turn = 0;
                save();
            } else {

                talent_display()

                if (wow.talent4 == "精力"){
                    energy[0] = 170
                    energy[2] = 1.1 
                }else{
                    energy[0] = 120
                    energy[2] = 1 
                }


                if(wow.crit == "" || wow.crit == null){
                }else{
                    document.getElementById("player_status").innerHTML = "主属性:" + wow.player_ap + "/暴击:" + wow.crit + "/急速:" + wow.haste + "/精通:" + wow.mastery + "/全能:" + wow.vers;
                }

                if(wow.boss_life == "" || wow.boss_life == null){
                }else{
                    document.getElementById("boss_status").innerHTML = "boss血量:" + wow.boss_life;
                }
                

            }

            document.getElementById("turn").innerHTML = "回合:" + wow.turn;


            display_combat_stat();
            
        }

        function display_combat_stat(){

            document.getElementById("energy").innerHTML = "能量:" + energy[0];
            document.getElementById("combo").innerHTML = "连击点数:" + combo;

            if(energy[0] < Garrote[0] || Garrote[4] != 0){
                document.getElementById("garrote").className = "button button-warning"
            }else{
                document.getElementById("garrote").className = "button button-primary"
            }
            if(energy[0] < Rupture[0] || combo == 0){
                document.getElementById("rupture").className = "button button-pill button-warning"
            }else{
                document.getElementById("rupture").className = "button button-pill button-action"
            }
            if(Shiv[4] != 0){
                document.getElementById("shiv").className = "button button-warning"
            }else{
                document.getElementById("shiv").className = "button button-primary"
            }
            if(energy[0] < Envenom[0] || combo == 0){
                document.getElementById("envenom").className = "button button-pill button-warning"
            }else{
                document.getElementById("envenom").className = "button button-pill button-action"
            }
        }

        function garrote_func(){
            news.newstext = "";
            document.getElementById("newstext").innerHTML = news.newstext;

            if(Garrote[4] == 0){
                if(energy[0] < Garrote[0]){
                }else{
                    energy[0] -= Garrote[0];
                    combo += Garrote[2];
                    if(combo > 5){
                        combo = 5;
                    }else{}
                    if(wow.talent2 == "诡诈"){
                        Garrote[4] = 0;
                        Garrote_damage = Garrote[3] * wow.player_ap * 1.8 / Garrote[1]
                    }else{
                        Garrote[4] = 6;
                        Garrote_damage = Garrote[3] * wow.player_ap / Garrote[1]
                    }
                    if(Garrote_dot <= Garrote[1]*0.3){
                        Garrote_dot += Garrote[1]
                    }else{
                        Garrote_dot = Garrote[1]
                    }
                    dot_display();
                    damage();
                }
            }else{}  
        }

        function mutilate_func(){
            news.newstext = "";
            document.getElementById("newstext").innerHTML = news.newstext;

            if(energy[0] < Mutilate[0]){
            }else{
                if(wow.lengend == "末日之刃"){

                }else{
                    energy[0] -= Mutilate[0];
                    crit_state = randomNum(0,10);
                    if (crit_state <= wow.crit*10){
                        crit_state = randomNum(0,10);
                        if (crit_state <= wow.crit*10){
                            //双手暴击
                            mutilate_crit(3)
                        }else{
                            //单手暴击
                            mutilate_crit(2)
                        }
                    }else{
                        //无暴击
                        mutilate_crit(1)
                    }
                    damage();
                }
            }

        }

        function mutilate_crit(crit_case){
            //1:无暴击，2:单手暴击，3:双手暴击
            if(crit_case == 1){
                combo += Mutilate[2]
                if(combo > 5){
                    combo = 5;
                }else{}
                Mutilate_damage = Mutilate[3] * (wow.vers + 1) * wow.player_ap;
                newstext("/毁伤"+ (Mutilate_damage).toFixed(0))
            }else if(crit_case == 2){
                combo += Mutilate[2] + 1
                if(combo > 5){
                    combo = 5;
                }else{}
                Mutilate_damage = Mutilate[3] * (wow.vers + 1) * wow.player_ap * 1.5;
                newstext("/毁伤(C)"+ (Mutilate_damage).toFixed(0))
            }
            else if(crit_case == 3){
                combo += Mutilate[2] + 2
                if(combo > 5){
                    combo = 5;
                }else{}
                Mutilate_damage = Mutilate[3] * (wow.vers + 1) * wow.player_ap * 2;
                newstext("/毁伤(CC)"+ (Mutilate_damage).toFixed(0))
            }else{}

            return Mutilate_damage
        }

        function rupture_func(){      
            news.newstext = "";
            document.getElementById("newstext").innerHTML = news.newstext;

            if(combo > 0){
                if(energy[0] >= Rupture[0]){
                    Rupture_dot = (combo + 1) * 4;
                    energy[0] -= Rupture[0];
                    Rupture_damage = (combo + 1) * Rupture[3] * wow.player_ap / Rupture_dot;
                    combo = 0;

                    if(Rupture_dot <= Rupture[1]*0.3){
                        Rupture_dot += Rupture[1];
                    }else{
                        Rupture_dot = Rupture[1];
                    }
                    dot_display();
                    damage();
                }else{
                    return;
                }
            }else{
                return;
            }
        }

        function shiv_func(){
            news.newstext = "";
            document.getElementById("newstext").innerHTML = news.newstext;

            if(Shiv[4] == 0){
                if(energy[0] < Shiv[0]){}
                else{
                    energy[0] -= Shiv[0];
                    combo += Shiv[2];
                    if(combo > 5){
                        combo = 5;
                    }else{}
                    
                    Shiv_dot += Shiv[1];
                    Shiv[4] = 25;

                    crit_state = randomNum(0,10);
                    if(crit_state <= wow.crit*10){
                        Shiv_damage = Shiv[3] * wow.player_ap * (wow.vers + 1) * 2;
                        newstext("/毒刃(C)"+ (Shiv_damage).toFixed(0));
                    }else{
                        Shiv_damage = Shiv[3] * wow.player_ap * (wow.vers + 1);
                        newstext("/毒刃"+ (Shiv_damage).toFixed(0));
                    }
                    
                    dot_display();
                    damage();
                }
            }
        }

        function envenom_func(){
            news.newstext = "";
            document.getElementById("newstext").innerHTML = news.newstext;

            if(combo > 0){
                if(energy[0] >= Envenom[0]){
                    Envenom_dot = combo + 1;
                    energy[0] -= Envenom[0];

                    crit_state = randomNum(0,10);
                    if(crit_state <= wow.crit*10){
                        Envenom_damage = Envenom[3] * combo * 2 * wow.player_ap * (wow.vers + 1) * 2;
                    }else{
                        Envenom_damage = Envenom[3] * combo * 2 * wow.player_ap * (wow.vers + 1);
                    }
                    combo = 0;
       
                    if(Envenom_dot <= Envenom[1]*0.3){
                        Envenom_dot += Envenom[1];
                    }else{
                        Envenom_dot = Envenom[1];
                    }
                    dot_display();
                    damage();
                }else{
                    return;
                }
            }else{
                return;
            }
        }

        function Poison_func(){

            var Poison_try = randomNum(0,10);
            var range = 0;
            if(Envenom_dot > 0){
                range = 8
            }else{
                range = 5
            }
            if(Poison_try <= range){
                if(Poison_state == 1){
                    crit_state = randomNum(0,10);
                    if (crit_state <= wow.crit*10){
                        Poison_damage = Poison[2] * wow.player_ap * (wow.vers + 1) * 2;
                        newstext("/毒药(C)"+ (Poison_damage).toFixed(0));
                    }else{
                        Poison_damage = Poison[2] * wow.player_ap * (wow.vers + 1);
                        newstext("/毒药"+ (Poison_damage).toFixed(0));
                    }
                    Poison_dot = Poison[1];
                }else{
                    Poison_state = 1;
                    Poison_dot = Poison[1];
                }
            }else{
            }
        }

        function wait(){
            news.newstext = "";
            document.getElementById("newstext").innerHTML = news.newstext;

            damage();
        }

        function damage(){

            if(Garrote_dot > 0){
                crit_state = randomNum(0,10);
                var damage_garrote = 0;
                if (crit_state <= wow.crit*10){
                    damage_garrote = ( Garrote_damage * (wow.haste + wow.mastery + 1) * (wow.vers + 1)) * 2;
                    newstext("/锁喉(C)"+ (damage_garrote).toFixed(0));
                }else{
                    damage_garrote = Garrote_damage * (wow.haste + wow.mastery + 1) * (wow.vers + 1);
                    newstext("/锁喉"+ (damage_garrote).toFixed(0));
                }
                Garrote_damage_sum += damage_garrote;
                wow.boss_life -= damage_garrote;
                Garrote_dot -= 1;                
            }else{}

            if (Garrote[4] > 0){
                Garrote[4] -= 1;
            }else{
                Garrote[4] = 0;
            }

            if(Rupture_dot > 0){
                crit_state = randomNum(0,10);
                var damage_rupture = 0;
                if (crit_state <= wow.crit*10){
                    damage_rupture = ( Rupture_damage * (wow.haste + wow.mastery + 1) * (wow.vers + 1)) * 2;
                    newstext("/割裂(C)"+ (damage_rupture).toFixed(0));
                }else{
                    damage_rupture = Rupture_damage * (wow.haste + wow.mastery + 1) * (wow.vers + 1);
                    newstext("/割裂"+ (damage_rupture).toFixed(0));
                }
                Rupture_damage_sum += damage_rupture;
                wow.boss_life -= damage_rupture;
                Rupture_dot -= 1;                
            }else{}

            Mutilate_damage_sum += Mutilate_damage;
            wow.boss_life -= Mutilate_damage;
            Mutilate_damage = 0;

            Shiv_damage_sum += Shiv_damage;
            wow.boss_life -= Shiv_damage;
            Shiv_damage = 0;

            if(Shiv[4] > 0){
                Shiv[4] -= 1;
            }else{
                Shiv[4] = 0;
            }

            if(Envenom_damage != 0){
                if(Shiv_dot > 0){
                    Envenom_damage_sum += Envenom_damage * 1.2;
                    wow.boss_life -= Envenom_damage * 1.2;
                    newstext("/毒伤"+ (Envenom_damage*1.2).toFixed(0));
                }else{
                    Envenom_damage_sum += Envenom_damage;
                    wow.boss_life -= Envenom_damage;
                    newstext("/毒伤"+ (Envenom_damage).toFixed(0));
                }
                Envenom_damage = 0;
            }

            if(Shiv_dot > 0){
                Shiv_dot -= 1;
            }else{
                Shiv_dot = 0;
            }

            if(Envenom_dot > 0){
                Envenom_dot -= 1;
            }else{
                Envenom_dot = 0;
            }

            Attack_damage = wow.player_ap * 0.1;
            var damage_attack = 0;
            crit_state = randomNum(0,10);
            if (crit_state <= wow.crit*10){
                damage_attack = ( Attack_damage * (wow.haste + 1) * (wow.vers + 1)) * 2;
                newstext("/攻击(C)"+ (damage_attack).toFixed(0));
            }else{
                damage_attack = Attack_damage * (wow.haste + 1) * (wow.vers + 1);
                newstext("/攻击"+ (damage_attack).toFixed(0));
            }
            Attack_damage_sum += damage_attack;
            wow.boss_life -= damage_attack;
      
            Poison_func();

            if(Poison_dot > 0){
                crit_state = randomNum(0,10);
                var damage_poison = 0;
                if (crit_state <= wow.crit*10){
                    damage_poison = ( Poison[3] * wow.player_ap * (wow.haste + wow.mastery + 1) * (wow.vers + 1) / Poison[1] ) * 2;
                    newstext("/毒药dot(C)"+ (damage_poison).toFixed(0));
                }else{
                    damage_poison = Poison[3] * wow.player_ap * (wow.haste + wow.mastery + 1) * (wow.vers + 1) / Poison[1];
                    newstext("/毒药dot"+ (damage_poison).toFixed(0));
                }
                Poison_damage_sum += damage_poison + Poison_damage;
                wow.boss_life -= damage_poison + Poison_damage;
                Poison_dot -= 1; 
                if(Poison_dot <= 0){
                    Poison_state = 0;
                }else{}
                Poison_damage = 0;               
            }else{}
            
            var DPS = (Garrote_damage_sum + Rupture_damage_sum + Mutilate_damage_sum + Shiv_damage_sum + Envenom_damage_sum + Poison_damage_sum + Attack_damage_sum) / wow.turn
            document.getElementById("damagetext").innerHTML = "锁喉" + Garrote_damage_sum.toFixed(0) + "/割裂" + Rupture_damage_sum.toFixed(0) + "/毁伤" + Mutilate_damage_sum.toFixed(0) + "/毒刃" + Shiv_damage_sum.toFixed(0) + "/毒伤" + Envenom_damage_sum.toFixed(0) + "/毒药" + Poison_damage_sum.toFixed(0) + "/攻击" + Attack_damage_sum.toFixed(0) + " || DPS:" + DPS.toFixed(0);

            dot_display();
            energy_regen()
            display_combat_stat();

            if(wow.boss_life == "" || wow.boss_life == null){
            }else{
                document.getElementById("boss_status").innerHTML = "boss血量:" + (wow.boss_life).toFixed(0);
            }

            wow.turn += 1;
            document.getElementById("turn").innerHTML = "回合:" + wow.turn;
        }

        function dot_display(){
            if(Garrote_dot > 0){
                document.getElementById("garrote_dot_display").innerHTML = "锁喉 dot:" + Garrote_dot;
                document.getElementById("garrote_dot_display").style = "display:inline";
            }else{
                document.getElementById("garrote_dot_display").style = "display:none";
            }

            if(Rupture_dot > 0){
                document.getElementById("rupture_dot_display").innerHTML = "割裂 dot:" + Rupture_dot;
                document.getElementById("rupture_dot_display").style = "display:inline";
            }else{
                document.getElementById("rupture_dot_display").style = "display:none";
            }

            if(Shiv_dot > 0){
                document.getElementById("shiv_dot_display").innerHTML = "毒刃 dot:" + Shiv_dot;
                document.getElementById("shiv_dot_display").style = "display:inline";
            }else{
                document.getElementById("shiv_dot_display").style = "display:none";
            }

            if(Envenom_dot > 0){
                document.getElementById("envenom_dot_display").innerHTML = "毒伤 dot:" + Envenom_dot;
                document.getElementById("envenom_dot_display").style = "display:inline";
            }else{
                document.getElementById("envenom_dot_display").style = "display:none";
            }

            if(Poison_dot > 0){
                document.getElementById("poison_dot_display").innerHTML = "毒药 dot:" + Poison_dot;
                document.getElementById("poison_dot_display").style = "display:inline";
            }else{
                document.getElementById("poison_dot_display").style = "display:none";
            }

        }
        
        function energy_regen(){
            var regen_slice = 0;
            var regen_rate = 0;
            /* if(slice_buff > 0){
                regen_rate += 0.1
            }else{}*/

            regen_rate += wow.haste;
            energy[2] = 1 + regen_rate;

            if(Rupture_dot>0 && Poison_state == 1){
                energy[0] += 8;
            }else{}
            if(Garrote_dot>0 && Poison_state == 1){
                energy[0] += 8;
            }

            energy[0] += 10 * energy[2] ;
            
            if(wow.talent4=="精力" && energy[0] > 170){
                energy[0] = 170;
            }else if(wow.talent4 !="精力" && energy[0] > 120){
                energy[0] = 120;
            }

            document.getElementById("energy").innerHTML = "能量:" + energy[0].toFixed(0);
        }

        function newstext(text) { //消息栏
            news.newstext = news.newstext + "||" + text;
            document.getElementById("newstext").innerHTML = news.newstext;
        }

        function delnews() {
            sure = confirm("确定删除消息?");
            if (sure == null || sure == false) {
                return;
            } else {
                news.newstext = "";
                document.getElementById("newstext").innerHTML = news.newstext;
                savenews();
            }
        }

        function deadand() { //传递信息给安卓的java 
            //var text=document.getElementById("text").value;  
            window.location = "javascript:window.android.deadand()";
        }
         
</script>
</body>


<script src="loadandsave.js"></script>
<script src="random.js"></script>
<script src="talentselect.js"></script>


</html>