<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.5">
    <title>WoW</title>
    <link rel="stylesheet" type="text/css" href="css/default.css">
    <link rel="stylesheet" href="css/style.min.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: auto;
            -moz-user-select: none;
            /*火狐*/
            -webkit-user-select: none;
            /*webkit浏览器*/
            -ms-user-select: none;
            /*IE10*/
            -khtml-user-select: none;
            /*早期浏览器*/
            user-select: none;
        }
        
        div {
            margin: 20px;
            border: 0;
            padding: 0;
            width: auto;
        }
        
        .lastResult {
            color: white;
            padding: 3px;
        }
    </style>

    <!-- Buttons 库的核心文件 -->
    <link rel="stylesheet" href="css/buttons.css">

    <!-- 当需要使用带下拉菜单的按钮时才需要加载下面的 JavaScript 文件 -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="jquery.min.js"></script>
    <script src="bootstrap.min.js"></script>

    <!-- 只有使用字体图标时才需要加载 Font-Awesome -->
    <link href="css/font-awesome.min.css" rel="stylesheet">


</head>

<body onload="onload()" class="text-align: center">


    <div id="wrapper" class="wrapper">
        <header class="header htmleaf-header">
            <h1>WoW<span>alpha:<text id="version"></text><br><a href="https://www.heguangyu.net" target="_blank">© heguangyu.net</a></span></h1>
        </header>
        <main>
            <div class="container">
                <section>

                    <div>
                        <p id="turn" class="button-border button-rounded button-primary">回合:</p>
                    </div>

                    <div>
                        <p id="news" onclick=delnews() class="button-border button-rounded button-primary" style="word-break:break-word;">消息栏: <text id="newstext"></text> </p>
                    </div>

                    <div>
                        <button id="boss_status" style="display: inline" class="button button-border button-rounded button-primary">boss血量:</button>
                        <button id="garrote_dot_display" style="display: none" class="button button-border button-rounded button-primary">锁喉 dot:</button>
                        <button id="rupture_dot_display" style="display: none" class="button  button-border button-rounded button-primary">割裂 dot:</button>
                        <button id="slice_time_display" style="display: none" class="button  button-border button-rounded button-primary">切割:</button>
                        <button id="shiv_dot_display" style="display: none" class="button  button-border button-rounded button-primary">毒刃 dot:</button>
                        <button id="envenom_dot_display" style="display: none" class="button button-border button-rounded button-primary">毒伤 dot:</button>
                        <button id="poison_dot_display" style="display: none" class="button button-border button-rounded button-primary">毒药 dot:</button>
                        <button id="planning_time_display" style="display: none" class="button button-border button-rounded button-primary">深谋:</button>
                        <button id="masterass_time_display" style="display: none" class="button button-border button-rounded button-primary">刺客大师:</button>
                    </div>

                    <div>
                        <p id="totaldamage" onclick="showhighestdps()" class="button-border button-rounded button-primary" style="word-break:break-word;">总伤害:  <text id="damagetext"></text> </p>
                    </div>

                    <div>
                        <div class="btn-group">
                            <button type="button" id="talent1" class=" button button-rounded" data-toggle="dropdown">
                                天赋1<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent1_1" href="javascript:talent1_1_func()">毒药大师</a>
                                </li>
                                <li>
                                    <a id="talent1_2" href="javascript:talent1_2_func()">深谋远虑</a>
                                </li>
                                <li>
                                    <a id="talent1_3" href="javascript:talent1_3_func()">侧袭</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="talent2" class=" button button-rounded" data-toggle="dropdown">
                                天赋2<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent2_1" href="javascript:talent2_1_func()">夜行者</a>
                                </li>
                                <li>
                                    <a id="talent2_2" href="javascript:talent2_2_func()">诡诈</a>
                                </li>
                                <li>
                                    <a id="talent2_3" href="javascript:talent2_3_func()">刺客大师</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="talent4" class=" button button-rounded" data-toggle="dropdown">
                                天赋4<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent4_1" href="javascript:talent4_1_func()">精力</a>
                                </li>
                                <li>
                                    <a id="talent4_2" href="javascript:talent4_2_func()">运筹帷幄</a>
                                </li>
                                <li>
                                    <a id="talent4_3" href="javascript:talent4_3_func()">死亡标记</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="talent3" class=" button button-rounded" data-toggle="dropdown">
                                天赋3<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="talent3_1" href="javascript:talent3_1_func()">毒药炸弹</a>
                                </li>
                                <li>
                                    <a id="talent3_2" href="javascript:talent3_2_func()">隐刃</a>
                                </li>
                                <li>
                                    <a id="talent3_3" href="javascript:talent3_3_func()">猩红风暴</a>
                                </li>
                            </ul>
                        </div>

                        <div class="btn-group">
                            <button type="button" id="legend" class=" button button-rounded" data-toggle="dropdown">
                                橙装<span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a id="legend_1" href="javascript:legend1_func()">末日之刃</a>
                                </li>
                                <li>
                                    <a id="legend_2" href="javascript:legend2_func()">佐迪克徽章</a>
                                </li>
                                <li>
                                    <a id="legend_3" href="javascript:legend3_func()">刺客大师的决议</a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div>
                        <p id="player_status" onclick="set_stats()" class="button-border button-rounded button-primary">点击设置绿字</p>
                    </div>

                    <div>
                        <div class="button-group">
                            <button id="garrote" type="button" onclick="garrote_func()" style="display: inline" class="button button-primary">锁喉</button>
                            <button id="mutilate" type="button" onclick="mutilate_func()" style="display: inline" class="button button-primary">毁伤</button>
                            <button id="shiv" type="button" onclick="shiv_func()" style="display: inline" class="button button-primary">毒刃</button>
                            <button id="kniev" type="button" onclick="kniev_func()" style="display: none" class="button button-primary">刀扇</button>
                            <button id="ambush" type="button" onclick="ambush_func()" style="display: inline" class="button button-primary">伏击</button>
                            <button id="vanish" type="button" onclick="vanish_func()" style="display: inline" class="button button-primary">消失</button>
                        </div>
                        <br>
                        <div class="button-group">
                            <button id="rupture" type="button" onclick="rupture_func()" style="display: inline" class="button button-pill button-warning">割裂</button>
                            <button id="envenom" type="button" onclick="envenom_func()" style="display: inline" class="button button-pill button-warning">毒伤</button>
                            <button id="crimson" type="button" onclick="crimson_func()" style="display: none" class="button button-pill button-warning">猩红风暴</button>
                            <button id="deathmark" type="button" onclick="deathmark_func()" style="display: none" class="button button-pill button-action">死亡标记</button>
                            <button id="vendetta" type="button" onclick="vendetta_func()" style="display: inline" class="button button-pill button-action">宿敌</button>
                            <button id="slice" type="button" onclick="slice_func()" style="display: inline" class="button button-pill button-warning">切割</button>                        
                        </div>
                        <br>
                        <div class="button-group">
                            <button id="wait" type="button" onclick="wait()" style="display: inline" class="button button-pill button-primary">发呆</button>
                        </div>

                    </div>

                    <div>
                        <p id="energy" class="button button-border button-rounded button-primary">能量:</p>
                        <p id="combo" class="button button-border button-rounded button-primary">连击点数:</p>
                        <p id="life" class="button button-border button-rounded button-primary"></p>
                    </div>

                    <div class="btn-group">
                        <button type="button" id="settings" class=" button button-rounded" data-toggle="dropdown">
                            设置<span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li>
                                <a id="settings_1" href="javascript:hintsetting()">关闭提示</a>
                            </li>
                            <li>
                                <a id="settings_2" href="javascript:reset()">重置</a>
                            </li>
                            <li>
                                <a id="settings_3" href="javascript:test()">加载测试配置</a>
                            </li>
                        </ul>
                    </div>

                </section>
            </div>
        </main>
    </div>

    <script src="js/production/materialMenu.min.js"></script>

    <script>
        var localStorage = window.localStorage;

        var wowstr;
        var wow = {
            talent1: "",
            talent2: "",
            talent3: "",
            talent4: "",
            legend: "",
            crit: "",
            haste: "",
            mastery: "",
            vers: "",
            turn: "",
            boss_life: "",
            player_life: "",
            player_ap: "",
            highest_dps: "",
        };

        var newstr;
        var news = {
            newstext: ""
        }

        var hint = 1; //用于设置是否需要提醒，默认1为打开，0为关闭
        function hintsetting() {
            if (hint == 1) {
                hint = 0;
                newstext("游戏提示已关闭")
                document.getElementById("hintset").innerHTML = "打开提示";
            } else {
                hint = 1;
                newstext("游戏提示已打开")
                document.getElementById("hintset").innerHTML = "关闭提示";
            }
        }

        function restart() {
            var sure;
            sure = confirm("确认删除存档吗！?")
            if (sure == true) {
                localStorage.clear();
                location.reload();
            } else {}
        }

        function test() {
            //测试用

            wow.crit = 0.3;
            wow.haste = 0.3;
            wow.mastery = 0.3;
            wow.vers = 0.1;
            wow.turn = 1;

            wow.player_ap = 1500 * 1.17 * 1.51;

            wow.boss_life = 1000000;

            news.newstext = "";
            newstext("已加载测试数据");
            savenews();
            save();
            onload();
            location.reload();
        }

        function onload() {

            document.getElementsByTagName('body')[0].style.zoom = 0.8

            var myDate = new Date();
            var version = myDate.toLocaleString();

            document.getElementById("version").innerHTML = "210417 - 1700";

            load();

            if (news.newstext == null) {
                news.newstext = "";
            }
            document.getElementById("newstext").innerHTML = news.newstext;

            if (wow.turn == null || wow.turn == "") {
                wow.turn = 1;
                save();
            } else {

                talent_display()

                if (wow.talent4 == "精力"){
                    energy[0] = 170
                    energy[2] = 1.1 
                }else{
                    energy[0] = 120
                    energy[2] = 1 
                }

                if(wow.talent4 == "死亡标记"){
                    document.getElementById("deathmark").style = "display:inline"
                }else{
                    document.getElementById("deathmark").style = "display:none"
                }


                if(wow.crit == "" || wow.crit == null){
                }else{
                    crit_ini = wow.crit;
                    mastery_ini = wow.mastery;
                    document.getElementById("player_status").innerHTML = "主属性:" + wow.player_ap.toFixed(0) + "/暴击:" + wow.crit + "/急速:" + wow.haste + "/精通:" + wow.mastery + "/全能:" + wow.vers;
                }

                if(wow.boss_life == "" || wow.boss_life == null){
                }else{
                    document.getElementById("boss_status").innerHTML = "boss血量:" + wow.boss_life;
                }
                

            }

            document.getElementById("turn").innerHTML = "回合:" + wow.turn;

            crit_ini = wow.crit;


            display_combat_stat();
            
        }

        function showhighestdps(){
            alert("已储存最高dps：" + wow.highest_dps.toFixed(0));
        }

        function display_combat_stat(){

            document.getElementById("energy").innerHTML = "能量:" + energy[0];
            document.getElementById("combo").innerHTML = "连击点数:" + combo;

            if(energy[0] < Garrote[0] || Garrote[4] != 0){
                document.getElementById("garrote").className = "button button-warning"
            }else{
                document.getElementById("garrote").className = "button button-primary"
            }
            if(energy[0] < Rupture[0] || combo == 0){
                document.getElementById("rupture").className = "button button-pill button-warning"
            }else{
                document.getElementById("rupture").className = "button button-pill button-action"
            }
            if(Shiv[4] != 0){
                document.getElementById("shiv").className = "button button-warning"
                document.getElementById("shiv").innerHTML = "毒刃" + Shiv[4]
            }else{
                document.getElementById("shiv").className = "button button-primary"
                document.getElementById("shiv").innerHTML = "毒刃"
            }
            if(energy[0] < Envenom[0] || combo == 0){
                document.getElementById("envenom").className = "button button-pill button-warning"
            }else{
                document.getElementById("envenom").className = "button button-pill button-action"
            }

            if(energy[0] < Slice[0] || combo == 0){
                document.getElementById("slice").className = "button button-pill button-warning"
            }else{
                document.getElementById("slice").className = "button button-pill button-action"
            }

            if(energy[0] < Mutilate[0]){
                document.getElementById("mutilate").className = "button button-warning"
            }else{
                document.getElementById("mutilate").className = "button button-primary"
            }

            if(ambush_state == 1){
                document.getElementById("ambush").className = "button button-caution"
            }else if(vanish_state == 0){
                if(energy[0] < Ambush[0]){
                    document.getElementById("ambush").className = "button button-warning"
                }else{
                    document.getElementById("ambush").className = "button button-primary"
                }
            }
            else{
                document.getElementById("ambush").className = "button button-warning"
            }

            if(vanish_cd == 0){
                document.getElementById("vanish").className = "button button-primary"
                document.getElementById("vanish").innerHTML = "消失"
            }else{
                document.getElementById("vanish").className = "button button-warning"
                document.getElementById("vanish").innerHTML = "消失" + vanish_cd
            }
            
            if(vanish_state == 0){
                document.getElementById("life").style = "display:inline"
                document.getElementById("life").innerHTML = "潜行中"
                document.getElementById("life").className = "button-border button-rounded button-caution"
            }else{
                document.getElementById("life").style = "display:none"
            }

            if(deathmark_cd == 0){
                document.getElementById("deathmark").className = "button button-pill button-action"
                document.getElementById("deathmark").innerHTML = "死亡标记"
            }else{
                document.getElementById("deathmark").className = "button button-pill button-warning"
                document.getElementById("deathmark").innerHTML = "死亡标记" + deathmark_cd
            }

            if(vendetta_time > 0){
                document.getElementById("vendetta").className = "button button-pill button-caution"
                document.getElementById("vendetta").innerHTML = "宿敌" + vendetta_time
            }else{
                if(vendetta_cd == 0){
                    document.getElementById("vendetta").className = "button button-pill button-action"
                    document.getElementById("vendetta").innerHTML = "宿敌"
                }else{
                    document.getElementById("vendetta").className = "button button-pill button-warning"
                    document.getElementById("vendetta").innerHTML = "宿敌" + vendetta_cd
                }
            }
        }

        function dot_display(){
            if(Garrote_dot > 0){
                document.getElementById("garrote_dot_display").innerHTML = "锁喉 dot:" + Garrote_dot;
                document.getElementById("garrote_dot_display").style = "display:inline";
                if(Garrote_dot <= Garrote[1]*0.3){
                    document.getElementById("garrote_dot_display").className = "button button-border button-rounded button-caution"
                }else{
                    document.getElementById("garrote_dot_display").className = "button button-border button-rounded button-primary"
                }
            }else{
                document.getElementById("garrote_dot_display").style = "display:none";
            }

            if(Rupture_dot > 0){
                document.getElementById("rupture_dot_display").style = "display:inline";
                document.getElementById("rupture_dot_display").innerHTML = "割裂 dot:" + Rupture_dot;
                if(Rupture_dot <= Rupture[1]*0.3){
                    document.getElementById("rupture_dot_display").className = "button button-border button-rounded button-caution"
                }else{
                    document.getElementById("rupture_dot_display").className = "button button-border button-rounded button-primary"
                }
            }else{
                document.getElementById("rupture_dot_display").style = "display:none";
            }

            if(Shiv_dot > 0){
                document.getElementById("shiv_dot_display").innerHTML = "毒刃 dot:" + Shiv_dot;
                document.getElementById("shiv_dot_display").style = "display:inline";
            }else{
                document.getElementById("shiv_dot_display").style = "display:none";
            }

            if(Envenom_dot > 0){
                document.getElementById("envenom_dot_display").innerHTML = "毒伤 dot:" + Envenom_dot;
                document.getElementById("envenom_dot_display").style = "display:inline";
            }else{
                document.getElementById("envenom_dot_display").style = "display:none";
            }

            if(Poison_dot > 0){
                document.getElementById("poison_dot_display").innerHTML = "毒药 dot:" + Poison_dot;
                document.getElementById("poison_dot_display").style = "display:inline";
            }else{
                document.getElementById("poison_dot_display").style = "display:none";
            }

            if(planning_time > 0){
                document.getElementById("planning_time_display").innerHTML = "深谋:" + planning_time;
                document.getElementById("planning_time_display").style = "display:inline";
            }else{
                document.getElementById("planning_time_display").style = "display:none";
            }

            if(slice_time > 0){
                document.getElementById("slice_time_display").innerHTML = "切割:" + slice_time;
                document.getElementById("slice_time_display").style = "display:inline";
            }else{
                document.getElementById("slice_time_display").style = "display:none";
            }

            if(legend_masterass_time > 0){
                document.getElementById("masterass_time_display").innerHTML = "刺客大师L:" + legend_masterass_time;
                document.getElementById("masterass_time_display").style = "display:inline";
                document.getElementById("legend").className = "button button-caution";
            }else if(masterass_time > 0){
                document.getElementById("masterass_time_display").innerHTML = "刺客大师:" + masterass_time;
                document.getElementById("masterass_time_display").style = "display:inline";
            }else{
                document.getElementById("masterass_time_display").style = "display:none";
                document.getElementById("legend").className = "button"
            }
            

        }
        
        function newstext(text) { //消息栏
            news.newstext = news.newstext + "||" + text;
            document.getElementById("newstext").innerHTML = news.newstext;
        }

        function delnews() {
            sure = confirm("确定删除消息?");
            if (sure == null || sure == false) {
                return;
            } else {
                news.newstext = "";
                document.getElementById("newstext").innerHTML = news.newstext;
                savenews();
            }
        }

        function deadand() { //传递信息给安卓的java 
            //var text=document.getElementById("text").value;  
            window.location = "javascript:window.android.deadand()";
        }
         
</script>
</body>


<script src="loadandsave.js"></script>
<script src="random.js"></script>
<script src="talentselect.js"></script>
<script src="garrote.js"></script>
<script src="multilate.js"></script>
<script src="rupture.js"></script>
<script src="shiv.js"></script>
<script src="envenom.js"></script>
<script src="poison.js"></script>
<script src="ambush.js"></script>
<script src="combat.js"></script>
<script src="cooldown.js"></script>
<script src="slice.js"></script>
<script src="talents.js"></script>


</html>